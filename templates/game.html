{% extends "base.html" %}
{% block game %}

<div class="row align-items-end">
        <div class="col-1 offset-1">
            <p class="mb-0"><strong>Deck</strong></p>
            <p><small>{{num_cards_in_deck}} cards remain</small></p>
            <!--Deck-->
            <form action="/draw_card_from_deck" method="post">
                <div class="overlay-button-container">
                    <img class="card_on_hand" src="../static/css/other/deck-full.png">
                    {% if game_phase == "Draw" %}
                    <input class="btn btn-dark" type="submit" value="Draw card">
                    {% endif %}
                </div>
            </form>
        </div>
        <!--Discard pile-->
            {% for player_name in top_discard_cards %}
                <div class="col-1">
                    <p class="mb-0 mt-3"><strong>Discard pile</strong></p>
                <p><small>{{player_name}}</small></p>
                {% set top_discard_card = top_discard_cards[player_name] %}
                {% if top_discard_card != None %}
                    <div class="overlay-button-container">
                    <img class="card_on_hand" src="../static/css/playing_cards/{{top_discard_card}}.png">
                    {% if game_phase == "Draw" %}
                        <form action="/draw_from_discard" method="post">
                            <input name="discard_owner" type="hidden" value="{{player_name}}">
                            <input class="btn btn-dark" type="submit" value="Draw card">
                        </form>
                    {% endif %}
                    </div>
                {% else %}
                    <img class="card_on_hand blank" src="../static/css/other/blank-w-border.png">
                {% endif %}
                    </div>
            {% endfor %}

    <div class="col-5">
        <!--Board-->
        <h4 class="mb-1">Current player's board ({{ current_player_name }})</h4>
        <table class="table-sm">
            {% for row in player_boards[current_player_name] %}
                {% set outer_loop = loop.index - 1 %}
                <tr>
                    {% for card in row %}
                        {% set inner_loop = loop.index - 1 %}
                        <td>
                            {% if card.card_name != None %}
                            <!-- TODO - address that IDs are 11, but values are (1,2). Make consistently 11?-->
                            <img class="card_on_board zoom" id="{{outer_loop}}{{inner_loop}}" src="../static/css/playing_cards/{{card.card_name}}.png">
                            {% else %}
                            {% if game_phase == "Choose Coords" %}
                            <form action="/choose_coordinates" method="post">
                                <input name="coords" type="hidden" value="{{outer_loop, inner_loop}}">
                                <input class="card_on_board blank blank_choose_coord" src="../static/css/other/blank-w-border.png"
                                       type="image">
                            </form>
                            {% else %}
                            <!-- Form tag is here to ensure formatting is the same as during coord selection -->
                            <form>
                            <!-- Not used - putting here to mirror padding when coords are being selected-->
                                <input disabled class="card_on_board blank" id="{{outer_loop}}{{inner_loop}}" src="../static/css/other/blank-w-border.png" type="image">
                            </form>
                            {% endif %}
                            {% endif %}
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    </div>
    <div class="col-3" id="parent">
        {% for player_name in player_boards %}
            {% if player_name != current_player_name %}
                <p><strong>{{ player_name }}'s board</strong></p>
                <table class="table-sm">
                {% for row in player_boards[player_name] %}
                    <tr>
                    {% for card in row %}
                        <td>
                        {% if card.card_name != None %}
                            <img class="card_on_mini_board zoom-larger" src="../static/css/playing_cards/{{card.card_name}}.png">
                        {% else %}
                            <img class="card_on_mini_board blank" src="../static/css/other/blank-w-border.png">
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            {% endif %}
        {% endfor %}
        <table class="table-sm">
    </div>
</div>

<div class="row fixed-bottom justify-content-center mb-2">
        {% for card in player_hands[current_player_name] %}
        <div class="col-1">
                <div class="overlay-button-container">
                <img class="card_on_hand" src="../static/css/playing_cards/{{card}}.png">
                {% if game_phase == "Choose Card" %}
                    <form action="/play_card" method="post">
                        <input name="card_name" type="hidden" value="{{card}}">
                        <input type="submit" class="btn btn-dark" value="Play card">
                    </form>
                {% elif game_phase == "Choose Discard" %}
                    <form action="/discard_card" method="post">
                        <input name="card_name" type="hidden" value="{{card}}">
                        <input type="submit" class="btn btn-dark" value="Discard card">
                    </form>
                {% endif %}
                </div>
        </div>
    {% endfor %}
</div>

{% endblock %}
